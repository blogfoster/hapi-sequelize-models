# run on container based infrastructure
sudo: false

language: node_js
node_js:
  - "5"

cache:
  directories:
    - "./node_modules"

branches:
  except:
    - "/^v[0-9]/" # dont build tags separately as they are build anyway for the push

install:
  - npm prune
  - npm install

script:
  - npm run eslint
  - npm test

deploy:
  provider: npm
  email: npm@blogfoster.com
  api_key:
    secure: J4WhHaVD5W8CAOBBMmw8J6Xe8QIIRXpsetBFqh+jA3mLgAoTy8gdqxVoQCoY8bPBiFZ4X4l6Ic10g6PRzpkBXET1MZpbcr4PSxndBnRLNAmW+Rh+gPj3zcNvYSZ5fHWHseNxtudZnccKL5lQSLWxYooY5U7hi20dSR3Q0PueGWOmxLn4yTfmzdCasmtAmfiMtn1dfepspRod8Ge6u1mVT0qA6bfRuQx8qL0wGb5fWhngRwCo5Ik+WvgRlD8vFQ6F8Rb5WMzkx8o3gD/I7WIneNlcW7k48E9XqijkAXg/MIl3VTIaVWgBi2v94QyBCC6TNZvDwFUF+x9xlf6ydAb7nqY3qhS36lw5jjZSaXYuTcztUVTRluXMRWN2T1gccD4RYIm0ndVFahSysotCh+r4Yww/pAkdsT61fE3upRzfHSexHE5eZ2tOlkUk+J2uyKT6esryrLtPLl5ICFAWEQ3e1sVvReUefzQtz14mx+aCLDq221bKqw3Nu4mgIEXTLcSH91R7d5bB+JKgCM25AAKaU/ZR+EymLQQRYAn9/dsxHZB3Uc05LBklRcpdJmg2yUNERmWWpWQNcUY9QZmWiJSrDAG2fxbqPA8jcc1tTf5XqrsyXKgtidyVtlgQk2Kt5cf534ke3HbfSSJKylctQ35HARvJjQIxs/LGbKOMRdpD2yU=
  wait-until-deployed: true
  skip_cleanup: true
  on:
    repo: blogfoster/hapi-sequelize-models
    branch: master
    condition: "$(git describe --exact-match HEAD)" # only deploy if the commit is referenced by a tag as well
