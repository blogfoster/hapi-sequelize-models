# run on container based infrastructure
sudo: false

language: node_js
node_js:
  - "5"

cache:
  directories:
    - "./node_modules"

branches:
  except:
    - "/^v[0-9]/" # dont build tags separately as they are build anyway for the push

install:
  - npm prune
  - npm install

script:
  - npm run eslint
  - npm test

deploy:
  provider: npm
  email: npm@blogfoster.com
  api_key:
    secure: "uPcb5cWZQ5hWONavhpOFQFmfgZdELebZdnVQSPSW6B8B8+zp1tL0e9xy1rxBJdO9P3p9U432QLEuflrGvnJ9JCr/rOqDP+Ljla2081hQP47GCAz8Wi1z7i32lY/OoIOjoTToSCz4POL+JM3FleJcTjAyJHO8ieiJsW3W7CQvb8l1P7qDdAnPNkJMQwiz7YXNvoElJXOW290eTyT388k/Yy3Xdt7SF/cl+Mv3AZ+l4HFdCE5pnbiy9Y2QUy/TwNmZ6DjcQ+rJkGDcAC7kik8+unuJDdyyAKvvNzT2AP4lmUPPKKhgWu8YmmV88LTqnmLnQwvBTMAfzBu6hWLghqKOoZKQB1EPuL63LP3ujboJ9ZKkBixf8Zizz8F5v65k/8BLHAIX/f3z3YwH1jSZwBaAcxy/PrK19g4yghWWl2UNuij8ZLBW33K90TnF1qKHXlbdflbAb9UnxFCUrUbUAM5J3IYCsfvQu5ushaAAwBfz96urmnMaGF8xR61Eb8scrNqbyZtpbdEhP9grUFU7owsMv9o+s7yj7tuL3jC+NDnDrcrWYWe+2dUornAmO0pQY1eEvNcTZZt6qAL/zmcyOe6RF5bxUQTImXnSegPL7GJYK8Qcv5ApKSiYIyMT1EvlgV3rkkyPwjaMcAPm64vEM7vnI5N3sIHmixBWnmSuTYk1ZcQ="
  wait-until-deployed: true
  skip_cleanup: true
  on:
    repo: blogfoster/hapi-sequelize-models
    branch: master
    condition: "$(git describe --exact-match HEAD)" # only deploy if the commit is referenced by a tag as well
