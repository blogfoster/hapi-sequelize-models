# dont run on container based infrastructure
sudo: false
dist: trusty
group: travis_latest

language: node_js
node_js:
  - '8'

cache:
  directories:
    - './node_modules'

branches:
  except:
    - /^v[0-9]/ # dont build tags separately as they are build anyway for the push

install:
  - npm prune
  - npm install

before_script:
  - npm run check

script:
  - npm test

deploy:
  provider: npm
  email: npm@blogfoster.com
  api_key:
    secure: "RBDxb1yn3ElTsl1Y27BDCSoypGxVG8yP7OU/dxmzW/BRGuTpxIr5eCCEsC8KZU1x0m8BVA30i2EKHcKyE9vV36+nrEtkdmF2H8hMpYIc5+3EFi/MVucW/VvnQjKnWqXtJRUazhPqQPIP9AeMl7rSvXZ32q9Jm6A+3t/MUTapPMb0aY1pCm82TxKKwuhTeNAHkGRRKmpbOp1DfMFujrugVBaVHl4UPa1E9UtKS0tEEI07sITJ6qxVdbS5HIftLoIKYbNZ13cVdPLaxFnK3z9zkMbfFYNn20Zqyijg38uNpQoMAGlWYcgxOurkBVbQLURHwpLss28UQTHNXHbt7s/4t/10PJAsrlJPxNLr2louyhYG+r8pId3P+SDFzS7zXi0VmLAOx3+43mDFfMvMQzpWg2DTtGQJJR6vBstjdSAPQg3/FqzZAnnGLtb3s4ifS4syp1KLjJ3IXalxxr0cYzwkv/32MkrsG5bbTn7wXOpnWuJuiegjPvHTxjxFyxe7pkBV2hVpB04kRF5NEvKeGh9otGqhOs7fm4P6wKdRIlDsNvyMHqciO3YBLmZGjc7pwk7R2au8oCAUykQq0m05YLxgxiGt9uJt7vTTjpK0G6E8zGds3gNDby0tmZIsvOEdff4hvhkyf4vfYENfbK7pMAXl6qNvxgvsPjZGp8rT0qxzOmY="
  wait-until-deployed: true
  skip_cleanup: true
  on:
    repo: blogfoster/hapi-sequelize-models
    branch: master
    condition: "$(git describe --exact-match HEAD)" # only deploy if the commit is referenced by a tag as well
