# dont run on container based infrastructure
sudo: false
dist: trusty
group: travis_latest

language: node_js
node_js:
  - '8'

cache:
  directories:
    - './node_modules'

branches:
  except:
    - /^v[0-9]/ # dont build tags separately as they are build anyway for the push

install:
  - npm prune
  - npm install

before_script:
  - npm run check

script:
  - npm test

deploy:
  provider: npm
  email: npm@blogfoster.com
  api_key:
    secure: "N/GBNdQ8QcDl/uhFbxYoqk0Z0rOcGHNBef6mUrnUMP+U6W1u8W2UmyZp0AxZpOwqP9b2Tlk1pwYuNNYzgrO32I3N97la00apagxELVS3I4rATQ4irLQxi2ApHdSVYyYIUXGTqp6s75Ues69oCS6EeNXJAhIHXVzRhQefgeVYq0fYO8niCpo43o4sVTVi56ErxE8luQzJtThjcwTFcDvJhQUglZ+YnRxGlwfuwowbNAiOrt9Ud/tlOZMp+dGaPK/LDZYm9BZbCbuK1H4vm1QSVGHB90/3FiQUScKSHLCeNr15xiTEyQPiSLM2xGEF058FMwFxi+/Y439MfIDWsZoFg0ZMMmih4aXJFEL1OAamdrt6O7dSOJ7pK6mj6PS3y217vBxwMija/l86p8hgbBS1YoC0zgfT1wvEQVe5YlfO8p9umJC5tNnC2LaZOyE64Z+0fbVnup/lel3Au/02KMPhxkwB3RWfXteEisjHZmFsf8GD1cPDHZl9DorCmc0aGIuBoni09Zga3P4Y+riyV6Cy5oet24xRifeacM3Hy1avI/M75jjnqhwAdmro78fSO2eonLjeNCW0VhnjbSWtyCzP2+SqKe9dgpgIMxQIzKyxVUeQTNIzI0cP3RsG8o79V+GhkEKGFb94DNw8joK0Kz0yHgE8/acc9wTZmT8eWVL1Iqg="
  wait-until-deployed: true
  skip_cleanup: true
  on:
    repo: blogfoster/hapi-sequelize-models
    branch: master
    condition: "$(git describe --exact-match HEAD)" # only deploy if the commit is referenced by a tag as well
